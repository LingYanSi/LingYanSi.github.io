<!DOCTYPE html>
<html lang="en">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
  <link rel="stylesheet" href="css/reset.css">
  <link rel="shortcut icon" href="" />
  <title></title>
  <style type="text/css">
	  *{margin:0;padding:0;}
	  #nav{width:100%;height:50px;overflow:hidden;background-color:rgb(0,255,255);}
	  #nav-wrap{height:50px;width:1050px;line-height:50px;text-align:center;}
	  .nav-item{width:150px;height:50px;float:left;box-sizing:border-box;}
	  .nav-item + .nav-item{border-left:1px solid rgba(0,0,0,0.2)}

	  .change{-webkit-transition:-webkit-transform 0.4s ;}

	  body{
			min-height:667px;
			background-image:url(img/1.png),url(img/2.png);
			background-size:40%,cover;
			background-repeat:no-repeat,no-repeat;
			background-position:center,center;
			}
  </style>
 </head>
 <body>
	<div id="wrap" class="wrap">
		<div id="main" class="main">
			<div id="nav">
				<div id="nav-wrap" class="">
					<div class="nav-item"><a href="sudu.html">1111</a></div>
					<div class="nav-item">222222</div>
					<div class="nav-item">33333</div>
					<div class="nav-item">44444</div>
					<div class="nav-item">555555555</div>
					<div class="nav-item">666666</div>
					<div class="nav-item">777</div>
				</div>
			</div>
			<a href="javascript:history.go(-1)">dfgsdfg</a>
		</div>
	</div>
<script src="js/ku.js"></script>
 <script type="text/javascript">
	window.onload = function(){
		navTouch('nav');
		function navTouch(idname){
			var nav = document.querySelector('#'+idname);
			var navWrap = nav.firstElementChild ;
			var xx,yy,XX,YY,swipeX,swipeY ;
			var currentX = 0 ;
			var v = 0 ;
			var t1 = t2 = 0 ;
			var x1 = x2 = 0 ;
			var L = 200 ; // 恒定值与速度相乘得出要移动的距离
			var navWidth = nav.offsetWidth ,
				navWrapWidth = navWrap.offsetWidth ;
			var disMax = 0 ;
			var disMin = navWidth - navWrapWidth ;
			nav.addEventListener('touchstart',function(event){
				navWrap.classList.remove('change');
				XX = xx = event.targetTouches[0].screenX ;
				YY = yy = event.targetTouches[0].screenY ;
				t2 = t1 = new Date().getTime() ;
				x2 = x1 = xx ;
				swipeX = true ;
				swipeY = true ;
			})
			nav.addEventListener('touchmove',function(event){
				XX = event.targetTouches[0].screenX ;
				YY = event.targetTouches[0].screenY ;
				if(swipeX && Math.abs(XX-xx)-Math.abs(YY-yy)>0)
				{
					event.stopPropagation();
					event.preventDefault();
					swipeY = false ;
					if (t2-t1>=50)
					{
						t1 = t2 ;
						x1 = x2 ;
					}
					t2 = new Date().getTime() ;
					x2 = XX ;
					navWrap.style.webkitTransform = 'translate3d('+(currentX + XX-xx)+'px,0,0)';
				}else if (swipeY && Math.abs(XX-xx)-Math.abs(YY-yy)<0)
				{
					swipeX = false ;
				}
			})
			nav.addEventListener('touchend',function(event){
				if (!swipeX) //如果不是左右滑动
				{
					swipeY = false ;
					swipeX = false ;
					return ;
				}
				currentX = currentX + XX-xx ;
				var v = (x2-x1)/(t2-t1) ; // 计算速度
				if(isNaN(v) || v===0) {
					if(currentX >= disMin && currentX <= disMax) return
					currentX = setDis(currentX);
					navWrap.classList.add('change');
					navWrap.style.webkitTransform = 'translate3d('+(currentX)+'px,0,0)';
					return
				} //如果速度不正常
				var distance = currentX+v*L ; // 计算translateX
				currentX = distance = setDis(distance);
				navWrap.classList.add('change');
				navWrap.style.webkitTransform = 'translate3d('+(distance)+'px,0,0)';
			});
			function setDis(distance){ // 重置translateX
				if(distance>disMax) distance = disMax
				else if(distance < disMin ) distance = disMin 
				return distance ;
			}
		}
		$('.nav-item').tap(function(event){
			//alert('我被电击了');
			event.preventDefault();
		});
		$('#nav-wrap').children().eq(2).css({'background':'red'})
	}
 </script>
 </body>
</html>
