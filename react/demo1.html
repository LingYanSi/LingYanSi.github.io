<html>
<head>
	<meta lang="zh-CN" charset="utf-8">
	<title>react练习1</title>
</head>
<body>
	<div id="title"></div>
	<div id="example"></div>
	<script src="framework/JSXTransformer.js"></script>
	<script src="framework/react.min.js"></script>
	<script type="text/jsx">
	window.onload = function(){
		
		/*
		*  创建一个评论组件
		*/
		var Aaaa = React.createClass({ // react组件名首字母要大些，用意是为了和标准的html标签区分
			getInitialState:function(){
				return {
					nima : false
				}
			},
			handleClick:function(){
				this.setState( {nima: !this.state.nima } );
				// alert('我被点击了');
			},
			edit:function(){
				console.log('双击时间')
				// alert('时代发生的发')
				this.refs.name.getDOMNode().setAttribute('contentEditable',true);
			},
			save:function(event){ // 保存数据
				if(event.keyCode && event.keyCode != 13) return
				this.refs.name.getDOMNode().removeAttribute('contentEditable');
			},
			del:function(){ // 其实根据flux，增删改查，不应直接反映在v上，应该先走model，数据改变后，在反映到view上
				// this.refs.
			},
			render : function(){
				var nima = this.state.nima ? '周芷若' : '赵敏' ;
				return (
					<h1 ref="item"> 
						<span class="name" ref="name" onDoubleClick ={ this.edit } onBlur={ this.save } onKeyDown={ this.save }>胡耀邦</span> 
						<span class="age">122</span> 
						<span onClick={ this.handleClick }>Hello {this.props.name}{nima}</span>
						<span onClick={ this.del }>删除</span>
					</h1>
				);
			}
		});

		var AddNote = React.createClass({ // 添加新条目组建
			handleClick:function(event){
				if( event.keyCode && event.keyCode != 13 ) return 
				if( this.refs.wName.getDOMNode().value && this.refs.wAge.getDOMNode().value ){
					alert('创建成功')
				}else{
					alert('信息不完整')
				}
				//  新增一个item
			},
			clearAll : function(){
				// 清空所有
			},
			render : function(){
				return (<div>
					<input type="text" id="wName" ref="wName" placeholder="名字" onKeyDown={ this.handleClick } /> 
					<input type="number" id="wAge" ref="wAge" placeholder="年龄" onKeyDown={ this.handleClick } /> 
					<button onClick={this.handleClick}>提交</button>
					<button onClick={ this.clearAll }>清空</button>
					</div>);
			}
		});

		var Comments = React.createClass({ // 主组件
			handleClick:function(event){
				// console.log('对方几乎是恐惧的');
				this.setState({
					itemCounts : 10
				})
			},
			getInitialState : function(){
				return {
					itemCounts : 5
				}
			},
			render : function(){
				var daye =  (function(_this){
					var arr = [] ;
					for( var i=0,len=_this.state.itemCounts ; i<len ; i++ ){
						arr.push(<Aaaa />);
					}
					return arr
				})(this);

				var mianStyle = { maxWidth:"900px" , margin:"0 auto" } ;
				var h1Style = { color:"rgb(247,105,105)" , fontSize:"3em" , lineHeight:"2" , textAlign:"center" } ;

				return (<div style={ mianStyle }>
					<h1 style={ h1Style } >React</h1>
					<AddNote></AddNote>
					<ol onClick={this.handleClick}>{daye}</ol>
				</div>);
			}
		})
		React.render(
			<Comments name="John" />,
			document.getElementById('example')
		);
	}
	</script>
</body>
</html>