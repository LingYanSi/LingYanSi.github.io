<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title></title>
    </head>
    <body>
        <h1>画板</h1>
        <p><input type="file">选择文件</p>
        <canvas id="canvas" width="300" height="300"></canvas>
        <p>
            <a href="" download >保存图片</a>
        </p>
        <script type="text/javascript">
            function $(s){
                return document.querySelector(s)
            }

            var cv = $('#canvas')
            var ct = cv.getContext('2d')

            var img = document.createElement('img')

            // 图片加载成功后，画图到canvas
            img.onload = function(){
                ct.drawImage(img,0,0,300,300)
                // 使用跨域图片，toDataURL会报错
            }

            // 本地选中文件后
            $('input').onchange = function(){
                var file = this.files[0]
                if(!file) return
                img.src = URL.createObjectURL(file)
            }

            // 下载图片
            $('a').addEventListener('click', function(){
                var url = cv.toDataURL('image/png')
                $('a').href = url
            })




        </script>
    </body>
</html>
