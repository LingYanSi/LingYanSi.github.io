<!DOCTYPE html>
<html lang="en">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
  <link rel="icon" href="http://lingyansi.github.io/images/icon/icon.jpg">
  <link rel="stylesheet" type="text/css" href="movie.css">
  <style type="text/css"></style>
  <title>生活-电影</title>
 </head>
 <body>
	<div id="wrap" class="wrap">
		<!-- 顶部导航 -->
		<nav>
			<div>
				<span class="nav-span-current">Film</span>
				<span>Tv</span>
			</div>
		</nav>
		<!-- 主内容 -->
		<article id="main" class="main">
			<!-- <a href="http://movie.douban.com/subject/1931974/" class="item" style="background-image:url(../../images/3.jpg);">
				<div>
					<p class="name">血色浪漫</p>
					<p>时间：<span class="time">2004</span> 导演：<span class="director">钟跃民</span></p>
				</div>
			</a> -->
		</article>
		<!-- 侧边栏 -->
		<aside>
			<img src="../../images/icon/icon.jpg">
			<p class="aside-title">灵岩</p>
			<div class="aside-urls">
				<p><a href="http://lingyansi.github.io">Gh</a></p>
				<p><a href="http://weibo.com/xuewumichen">Wb</a></p>
				<p><a href="http://www.douban.com/people/xuewumichen/">Db</a></p>
				<p><a href="http://sanweishuwu.lofter.com/">Lf</a></p>
			</div>
		</aside>
	</div>
 <script type="text/javascript" src="../../build-zepto/ku.js"></script>
 <script type="text/javascript" src="util-china.js"></script>
 <script type="text/javascript">
	var $main = document.querySelector('#main');

	// render单纯负责把数组转换成html字符串
	// 还需要数据的切换，查询，比如说我如何切换不同地区/不同类型？
	var movie = (function(List,$main){
		var movie = {
			init:function(type,area){
				if( type==this.state.type && area==this.state.area ) return
				this.state.type = type , this.state.area = area ; 
				var arr = List[type] ;
				this.render(arr);
			},
			render:function(list){
				var height = $main.clientWidth*9/16 ;
				var str = list.map(function(ele){
					return '<a href="'+ele.douban+'" target="_blank" class="item" style="background-image:url('+ele.poster+');height:'+height+'px;">'+
						'<div>'+
							'<p class="name">'+ele.name+'</p>'+
							'<p>'+
								'时间：<span className="time">'+ele.time+'</span>'+
								' 导演：<span className="director">'+ele.director+'</span>'+
							'</p>'+
						'</div>'+
					'</a>' ;
				}).join('');
				$main.innerHTML = str ;
			},
			state:{
				type:'',
				area:''
			}
		};
		movie.init('film'); // 初始化，默认加载film
		return movie ;
	})(List,$main);
	
	// 切换状态
	$('nav').find('span').on('click',function(){
		$(this).addClass('nav-span-current').siblings().removeClass('nav-span-current');
		if($(this).index()==0){
			movie.init('film');
		}else{
			movie.init('tv');
		}
	});

	// 窗口变化自适应
	$(window).on('resize',function(){
		if($main.clientWidth<=800){
			$('.item').css({'height':$main.clientWidth*9/16+'px'});
		}
	});
 </script>
 </body>
</html>
